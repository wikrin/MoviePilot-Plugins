import{importShared as e}from"./__federation_fn_import-D8XbxH1x.js";import{_ as l}from"./_plugin-vue_export-helper-BCo6x5W8.js";const{defineComponent:a}=await e("vue"),{resolveComponent:t,createVNode:i,createElementVNode:n,withCtx:o,toDisplayString:d,createTextVNode:s,openBlock:c,createBlock:r,createCommentVNode:u,withModifiers:m,createElementBlock:f}=await e("vue"),p={class:"plugin-config"},_={class:"setting-item d-flex align-center justify-space-between"},v={class:"d-flex align-center"},b={class:"related-components"},y={class:"setting-item d-flex align-center justify-space-between"},g={class:"d-flex align-center"},x={class:"setting-item d-flex align-center justify-space-between"},V={class:"setting-item d-flex align-center justify-space-between"},h={class:"setting-item mb-2"},w={class:"setting-item mb-2"},U={class:"setting-item mb-2"},j={class:"setting-item d-flex align-center py-2"},k={class:"setting-item mb-2"},C={class:"setting-item d-flex align-center py-2"},z={class:"setting-item mb-2"},E={class:"setting-item mb-2"},{ref:B,reactive:J,onMounted:N}=await e("vue"),O=l(a({__name:"Config",props:{api:{type:Object,required:!0},initialConfig:{type:Object,default:()=>({})}},emits:["close","switch","save"],setup(e,{emit:l}){const a=e,O=l,F=J({cron_enabled:!1,downloader:[],exclude_dirs:"",exclude_tags:"",cron:"",event_enabled:!1,rename_torrent:!1,rename_file:!1,format_torrent_name:"{{ title }}{% if year %} ({{ year }}){% endif %}{% if season_episode %} - {{season_episode}}{% endif %}",format_save_path:"{{title}}{% if year %} ({{year}}){% endif %}",format_movie_path:"{{title}}{% if year %} ({{year}}){% endif %}{% if part %}-{{part}}{% endif %}{% if videoFormat %} - {{videoFormat}}{% endif %}{{fileExt}}",format_tv_path:"Season {{season}}/{{title}} - {{season_episode}}{% if part %}-{{part}}{% endif %}{% if episode %} - 第 {{episode}} 集{% endif %}{{fileExt}}"}),S=B([]),q=J({...F}),M=B(null),T=B(!0),D=B(null),I=B(null),A=B(!1),G=B("basic_tab");async function H(){if(T.value){A.value=!0,D.value=null;try{O("save",{...q})}catch(e){console.error("保存配置失败:",e),D.value=e.message||"保存配置失败"}finally{A.value=!1}}else D.value="请修正表单错误"}function K(){Object.keys(F).forEach((e=>{q[e]=F[e]})),M.value&&M.value.resetValidation()}return N((()=>{a.initialConfig&&Object.keys(a.initialConfig).forEach((e=>{e in q&&(q[e]=a.initialConfig[e])})),async function(){try{const e=await a.api.get("download/clients");S.value=[...e.map((e=>({title:e.name,value:e.name})))]}catch(e){console.error("加载下载器设置失败:",e)}}()})),(e,l)=>{const a=t("v-icon"),B=t("v-card-title"),J=t("v-alert"),N=t("v-switch"),F=t("v-col"),L=t("v-select"),P=t("VCronField"),Q=t("v-row"),R=t("v-card-text"),W=t("v-card"),X=t("v-tab"),Y=t("v-tabs"),Z=t("v-text-field"),$=t("v-textarea"),ee=t("v-window-item"),le=t("v-window"),ae=t("v-form"),te=t("v-btn"),ie=t("v-spacer"),ne=t("v-card-actions");return c(),f("div",p,[i(W,{flat:"",class:"rounded border"},{default:o((()=>[i(B,{class:"text-subtitle-1 d-flex align-center px-3 py-2 bg-primary-lighten-5"},{default:o((()=>[i(a,{icon:"mdi-cog",class:"mr-2",color:"primary",size:"small"}),l[17]||(l[17]=n("span",null,"路径名称格式化配置",-1))])),_:1,__:[17]}),i(R,{class:"px-3 py-2"},{default:o((()=>[D.value?(c(),r(J,{key:0,type:"error",density:"compact",class:"mb-2 text-caption",variant:"tonal",closable:""},{default:o((()=>[s(d(D.value),1)])),_:1})):u("",!0),I.value?(c(),r(J,{key:1,type:"success",density:"compact",class:"mb-2 text-caption",variant:"tonal",closable:""},{default:o((()=>[s(d(I.value),1)])),_:1})):u("",!0),i(ae,{ref_key:"form",ref:M,modelValue:T.value,"onUpdate:modelValue":l[14]||(l[14]=e=>T.value=e),onSubmit:m(H,["prevent"])},{default:o((()=>[i(W,{flat:"",class:"rounded mb-3 border config-card"},{default:o((()=>[i(B,{class:"text-caption d-flex align-center px-3 py-2 bg-primary-lighten-5"},{default:o((()=>[i(a,{icon:"mdi-tune",class:"mr-2",color:"primary",size:"small"}),l[18]||(l[18]=n("span",null,"工作方式",-1))])),_:1,__:[18]}),i(R,{class:"px-3 py-2"},{default:o((()=>[i(Q,null,{default:o((()=>[i(F,{cols:"12",md:"2"},{default:o((()=>[n("div",_,[n("div",v,[i(a,{icon:"mdi-power",size:"small",color:q.event_enabled?"success":"grey",class:"mr-3"},null,8,["color"]),l[19]||(l[19]=n("span",{class:"text-subtitle-2"},"事件监听",-1))]),i(N,{modelValue:q.event_enabled,"onUpdate:modelValue":l[0]||(l[0]=e=>q.event_enabled=e),color:"primary",inset:"",disabled:A.value,density:"compact","hide-details":"",class:"small-switch"},null,8,["modelValue","disabled"])])])),_:1}),i(F,{cols:"12",md:"10"},{default:o((()=>[n("div",b,[i(Q,null,{default:o((()=>[i(F,{cols:"12",md:"3"},{default:o((()=>[n("div",y,[n("div",g,[i(a,{icon:"mdi-clock",size:"small",color:q.cron_enabled?"info":"grey",class:"mr-3"},null,8,["color"]),l[20]||(l[20]=n("span",{class:"text-subtitle-2"},"定时任务",-1))]),i(N,{modelValue:q.cron_enabled,"onUpdate:modelValue":l[1]||(l[1]=e=>q.cron_enabled=e),color:"info",inset:"",disabled:A.value,density:"compact","hide-details":"",class:"small-switch"},null,8,["modelValue","disabled"])])])),_:1}),i(F,{cols:"12",md:"4"},{default:o((()=>[n("div",x,[l[21]||(l[21]=n("div",{class:"d-flex align-center"},[n("span",{class:"text-subtitle-2"},"下载器")],-1)),i(L,{modelValue:q.downloader,"onUpdate:modelValue":l[2]||(l[2]=e=>q.downloader=e),items:S.value,disabled:!q.cron_enabled,variant:"outlined",multiple:"",chips:"",clearable:"","item-title":"title","item-value":"value",density:"compact",class:"text-caption",style:{"max-width":"140px"}},null,8,["modelValue","items","disabled"])])])),_:1}),i(F,{cols:"12",md:"5"},{default:o((()=>[n("div",V,[l[22]||(l[22]=n("div",{class:"d-flex align-center"},[n("span",{class:"text-subtitle-2"},"执行周期")],-1)),i(P,{modelValue:q.cron,"onUpdate:modelValue":l[3]||(l[3]=e=>q.cron=e),density:"compact",class:"cron-field flex-grow-1 ml-2",disabled:!q.cron_enabled},null,8,["modelValue","disabled"])])])),_:1})])),_:1})])])),_:1})])),_:1})])),_:1})])),_:1}),i(W,{flat:"",class:"rounded mb-3 border config-card"},{default:o((()=>[i(B,{class:"text-caption d-flex align-center px-3 py-2 bg-primary-lighten-5"},{default:o((()=>[i(a,{icon:"mdi-clock-time-five",class:"mr-2",color:"primary",size:"small"}),l[23]||(l[23]=n("span",null,"格式设置",-1))])),_:1,__:[23]}),i(R,{class:"px-3 py-2"},{default:o((()=>[i(Y,{modelValue:G.value,"onUpdate:modelValue":l[4]||(l[4]=e=>G.value=e),class:"mb-3",density:"compact","fixed-tabs":""},{default:o((()=>[i(X,{value:"basic_tab"},{default:o((()=>l[24]||(l[24]=[s("基本设置")]))),_:1,__:[24]}),i(X,{value:"critical_tab"},{default:o((()=>l[25]||(l[25]=[s("实验性功能")]))),_:1,__:[25]})])),_:1},8,["modelValue"]),i(le,{modelValue:G.value,"onUpdate:modelValue":l[13]||(l[13]=e=>G.value=e)},{default:o((()=>[i(ee,{value:"basic_tab"},{default:o((()=>[i(Q,null,{default:o((()=>[i(F,{cols:"12",md:"7"},{default:o((()=>[n("div",h,[i(Z,{modelValue:q.format_save_path,"onUpdate:modelValue":l[5]||(l[5]=e=>q.format_save_path=e),label:"保存路径格式",hint:"使用Jinja2语法, 不会覆盖原保存路径, 仅追加. 留空不修改",clearable:"","persistent-hint":"",density:"compact",variant:"outlined"},null,8,["modelValue"])])])),_:1}),i(F,{cols:"12",md:"5"},{default:o((()=>[n("div",w,[i(Z,{modelValue:q.exclude_tags,"onUpdate:modelValue":l[6]||(l[6]=e=>q.exclude_tags=e),label:"排除标签",placeholder:"空白字符会排除所有未设置标签的种子",hint:"多个标签用, 分割",clearable:"","persistent-hint":"",density:"compact",variant:"outlined"},null,8,["modelValue"])])])),_:1})])),_:1}),i(Q,null,{default:o((()=>[i(F,{cols:"12"},{default:o((()=>[n("div",U,[i($,{modelValue:q.exclude_dirs,"onUpdate:modelValue":l[7]||(l[7]=e=>q.exclude_dirs=e),rows:"3","auto-grow":"",label:"排除目录",hint:"排除目录, 一行一个, 路径深度不能超过保存路径",placeholder:"例如:\n/mnt/download\nE:/download",clearable:"","persistent-hint":"",density:"compact",variant:"outlined"},null,8,["modelValue"])])])),_:1})])),_:1}),i(Q,null,{default:o((()=>[i(F,{cols:"12",md:"8"},{default:o((()=>[n("div",j,[i(N,{modelValue:q.rename_torrent,"onUpdate:modelValue":l[8]||(l[8]=e=>q.rename_torrent=e),label:"种子重命名",color:"primary",inset:"",disabled:A.value,density:"compact","hide-details":"",class:"small-switch"},null,8,["modelValue","disabled"])])])),_:1})])),_:1}),i(Q,null,{default:o((()=>[i(F,{cols:"12"},{default:o((()=>[n("div",k,[i($,{modelValue:q.format_torrent_name,"onUpdate:modelValue":l[9]||(l[9]=e=>q.format_torrent_name=e),rows:"2","auto-grow":"",label:"种子标题重命名格式",hint:"使用Jinja2语法, 所用变量与主程序相同",clearable:"","persistent-hint":"",density:"compact",variant:"outlined"},null,8,["modelValue"])])])),_:1})])),_:1}),i(J,{type:"info",variant:"tonal",icon:"mdi-information"},{default:o((()=>l[26]||(l[26]=[s(" 谨慎开启定时任务: 修改保存目录或种子文件都属于源目录操作, 已整理入库的文件会与整理记录失去关联! ")]))),_:1,__:[26]}),i(J,{type:"info",variant:"tonal",icon:"mdi-information"},{default:o((()=>l[27]||(l[27]=[s(" 种子重命名: 重命名种子在下载器显示的名称,qBittorrent 不会影响保存路径和种子内容布局; Transmission 不支持 ")]))),_:1,__:[27]})])),_:1}),i(ee,{value:"critical_tab"},{default:o((()=>[i(Q,null,{default:o((()=>[i(F,{cols:"12",md:"8"},{default:o((()=>[n("div",C,[i(N,{modelValue:q.rename_file,"onUpdate:modelValue":l[10]||(l[10]=e=>q.rename_file=e),label:"种子文件重命名(实验功能)",color:"primary",inset:"",disabled:A.value,density:"compact","hide-details":"",class:"small-switch"},null,8,["modelValue","disabled"])])])),_:1})])),_:1}),i(Q,null,{default:o((()=>[i(F,{cols:"12"},{default:o((()=>[n("div",z,[i($,{modelValue:q.format_movie_path,"onUpdate:modelValue":l[11]||(l[11]=e=>q.format_movie_path=e),rows:"3","auto-grow":"",label:"电影文件重命名格式",hint:"使用Jinja2语法, 所用变量与主程序相同",clearable:"","persistent-hint":"",density:"compact",variant:"outlined"},null,8,["modelValue"])])])),_:1})])),_:1}),i(Q,null,{default:o((()=>[i(F,{cols:"12"},{default:o((()=>[n("div",E,[i($,{modelValue:q.format_tv_path,"onUpdate:modelValue":l[12]||(l[12]=e=>q.format_tv_path=e),rows:"3","auto-grow":"",label:"电视剧文件重命名格式",hint:"使用Jinja2语法, 所用变量与主程序相同",clearable:"","persistent-hint":"",density:"compact",variant:"outlined"},null,8,["modelValue"])])])),_:1})])),_:1}),i(J,{type:"info",variant:"tonal",icon:"mdi-information"},{default:o((()=>l[28]||(l[28]=[s(" 谨慎开启 种子文件重命名, 会导致无法辅种和其他意料之外的问题, 增加种子维护难度 ")]))),_:1,__:[28]})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1}),i(ne,{class:"px-2 py-1"},{default:o((()=>[i(te,{color:"info",onClick:l[15]||(l[15]=e=>O("switch")),"prepend-icon":"mdi-view-dashboard",variant:"text",size:"small"},{default:o((()=>l[29]||(l[29]=[s("数据页")]))),_:1,__:[29]}),i(ie),i(te,{color:"secondary",variant:"text",onClick:K,"prepend-icon":"mdi-restore",size:"small"},{default:o((()=>l[30]||(l[30]=[s("恢复默认")]))),_:1,__:[30]}),i(te,{color:"primary",disabled:!T.value||A.value,onClick:H,loading:A.value,"prepend-icon":"mdi-content-save",variant:"text",size:"small"},{default:o((()=>l[31]||(l[31]=[s("保存配置")]))),_:1,__:[31]},8,["disabled","loading"]),i(te,{color:"grey",onClick:l[16]||(l[16]=e=>O("close")),"prepend-icon":"mdi-close",variant:"text",size:"small"},{default:o((()=>l[32]||(l[32]=[s("关闭")]))),_:1,__:[32]})])),_:1})])),_:1})])}}}),[["__scopeId","data-v-a9d86f3f"]]);export{O as default};
