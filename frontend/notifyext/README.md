## ğŸ‘‹ ä»‹ç»
MoviePilot æ¶ˆæ¯é€šçŸ¥æ‰©å±•æ’ä»¶ç”¨äºå¢å¼ºç³»ç»Ÿæ¶ˆæ¯é€šçŸ¥åŠŸèƒ½ï¼Œæ”¯æŒè‡ªå®šä¹‰æ¨¡æ¿å’Œåˆ†å‘è§„åˆ™ï¼Œå®ç°æ›´çµæ´»çš„æ¶ˆæ¯é€šçŸ¥ç®¡ç†ã€‚

## âœ¨ ç‰¹æ€§
- ğŸ”§ è‡ªå®šä¹‰æ¶ˆæ¯æ¨¡æ¿
- ğŸ“ çµæ´»çš„æ¶ˆæ¯åˆ†å‘è§„åˆ™
- ğŸ¯ æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…
- â° æ¶ˆæ¯å†·å´æ—¶é—´æ§åˆ¶
- ğŸ” å…ƒæ•°æ®æå–ä¸è¯†åˆ«

## âš™ï¸ é…ç½®è¯´æ˜

### åŸºç¡€é…ç½®
- `æ¶ˆæ¯å†·å´æ—¶é—´(åˆ†é’Ÿ)`: é˜²æ­¢çŸ­æ—¶é—´å†…é‡å¤å‘é€ç›¸åŒæ¶ˆæ¯.

### æ¶ˆæ¯æ¨¡æ¿
ä½¿ç”¨ä¸»ç¨‹åºç›¸åŒ`æ ¼å¼&è¯­æ³•`,
åœ¨`æ­£åˆ™åŒ¹é…`æ¨¡å¼ä¸‹æ”¯æŒè‡ªå®šä¹‰å­—æ®µçš„ä½¿ç”¨

### åˆ†å‘è§„åˆ™
åˆ†å‘è§„åˆ™å†³å®šæ¶ˆæ¯å¦‚ä½•è¢«å¤„ç†å’Œå‘é€ï¼š
> ç›®æ ‡æ¸ é“
> - æ¶ˆæ¯å‘å¾€ä½•å¤„

### ğŸŒ° æ­£åˆ™æ¨¡å¼ä½¿ç”¨ç¤ºä¾‹:

`extractors` ä¸­å®šä¹‰éœ€è¦æå–çš„ä¿¡æ¯, ä¾‹å¦‚
```yaml
extractors:
  - field: 'title' # ä»æ¶ˆæ¯çš„æ ‡é¢˜ä¸­åŒ¹é… é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ 'text:æ¶ˆæ¯å†…å®¹', 'link:æ¶ˆæ¯é“¾æ¥', 'image:å›¾ç‰‡åœ°å€' ...
    org_msg_title: '.*' # å­˜å‚¨åŸå§‹æ¶ˆæ¯æ ‡é¢˜åˆ° org_msg_title ä¸­

  - field: 'text' # ä»æ¶ˆæ¯çš„å†…å®¹ä¸­åŒ¹é…
    torrent_name: 'ä½ ä¸‹è½½çš„ç§å­''(?P<torrent_name>.*?)''è¢«ç®¡ç†å‘˜åˆ é™¤' # å­˜å‚¨ç§å­ååˆ° torrent_name ä¸­
    reason: 'åŸå› ï¼š(?P<reason>.*)' # å­˜å‚¨åŸå› åˆ° reason ä¸­
```
åœ¨æ¶ˆæ¯æ¨¡æ¿ä¸­å°±å¯ä½¿ç”¨`{% if org_msg_title %} {{ org_msg_title }}{% endif %}`  
å¦‚æœä½¿ç”¨`(?P<example>...)` åˆ™æ¨¡æ¿ä¸­éœ€è¦ä½¿ç”¨`{% if example %} {{ example }}{% endif %}` `MetaBase`ç»‘å®šåŒç†

`MetaBase` ä¸­å®šä¹‰å…ƒæ•°æ®å¯¹è±¡å±æ€§ä¸æå–ä¿¡æ¯çš„ç»‘å®šå…³ç³», ä¾‹å¦‚

```yaml
MetaBase:
  title: 'torrent_name'
```
æ­¤æ—¶`title` çš„å€¼ä¸º `extractors`ä¸­ `torrent_name` æ‰€åŒ¹é…çš„ç»“æœ, éœ€è¦è·å¾—åª’ä½“ä¿¡æ¯å¿…é¡»ç»‘å®š `title`ï¼Œå¦åˆ™æ¨¡æ¿ä¸­å¯ç”¨å­—æ®µä»…æœ‰ `extractors`ä¸­æå–çš„ç»“æœ
å¯ç»‘å®š`tmdbid`ç²¾å‡†è¯†åˆ«
æ›´å¤š`MetaBase`å±æ€§è§[MetaInfo](https://github.com/jxxghp/MoviePilot/blob/fcd5ca3fda1992ece6bb2111afa1b75909d0557f/app/schemas/context.py#L6-L61)

### æ¶ˆæ¯èšåˆ:

ä¸‹é¢ä»¥`è§‚ä¼—` åˆ ç§çš„`ç«™ç‚¹æ¶ˆæ¯`ä¸ºä¾‹:

è§„åˆ™YAMLæ¨¡æ¿
```yaml
extractors:
  - field: 'title'
    site_name: 'ã€ç«™ç‚¹\s+([^\s]+)\s+æ¶ˆæ¯ã€‘' # æå–ç«™ç‚¹åç§°

  - field: 'text'
    audiences: |-
      æ ‡é¢˜ï¼š(?P<title>ç§å­è¢«åˆ é™¤)
      å†…å®¹ï¼š
      ä½ ä¸‹è½½çš„ç§å­'(?P<torrent_name>[^']+)'è¢«ç®¡ç†å‘˜åˆ é™¤ã€‚åŸå› ï¼š(?P<reason>.+ã€‚)

Aggregate: # å­˜åœ¨å³å¼€å¯
  required: ['site_name', 'title', 'torrent_name', 'reason'] # éœ€è¦åŒ¹é…å…¨éƒ¨å­—æ®µæ‰ä¼šåŠ å…¥æ¶ˆæ¯èšåˆ, å¯æŒ‰åœºæ™¯å¢åˆ 
```
æ¶ˆæ¯æ¸²æŸ“æ¨¡æ¿
```json
{
    "title": "ğŸ“¢ ç«™ç‚¹æ¶ˆæ¯é€šçŸ¥",
    "text": (
        "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n"
        "{%- set sites = {} -%}"
        "{%- for msg in messages -%}"
        "{%- if msg.site_name and msg.reason -%}"
        "{%- set _ = sites.update({msg.site_name: msg.reason}) -%}"
        "{%- endif -%}"
        "{%- endfor -%}"
        "{%- for site, reason in sites.items() %}\n"
        "*ğŸ”¹ ç«™ç‚¹ï¼š{{ site }}*\n"
        "ğŸ”¸ åŸå› ï¼š{{ reason }}\n"
        "{%- for msg in messages if msg.site_name == site %}\n"
        "â¤ *{{ msg.torrent_name }}*"
        "{%- endfor -%}"
        "\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
        "{%- if not loop.last %}\n{% endif -%}"
        "{%- endfor -%}\n"
        "â° ç»Ÿè®¡æ—¶é—´ï¼š{{ last_time | truncate(16, True, '') }}"
    )
}
```
## ğŸ“ æ³¨æ„äº‹é¡¹
1. æ­£åˆ™è¡¨è¾¾å¼è§„åˆ™è¯·ç¡®ä¿æ ¼å¼æ­£ç¡®
